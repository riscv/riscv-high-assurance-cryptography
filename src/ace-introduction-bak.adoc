[[Introduction]]
== Introduction

#(The ratification plan can be found https://riscv.atlassian.net/wiki/spaces/HACX/pages/484966423/High+Assurance+Crypto+Ratification+Plan[here].)#

The _Atomic Cryptographic Extension_ (ACE) provides an interface to high-assurance cryptographic operations.
Its primary features are the concealment of key values and secrets, usage restrictions, and support for various cryptographic algorithms and hardened implementations.

ACE addresses use cases such as content protection, local LLM decryption, key and identity management, link and storage encryption, Secure Boot, and bootloader attestation.
It targets applications requiring cryptographic operations with high protection for keys and intermediate values.

Designed as an _attached_ unit, ACE functions like a coprocessor with a dedicated, low-latency interface to the CPU core.
Standard interrupts do not halt ACE operations; the implementation may stall the CPU pipeline only if a trap requires saving ACE state.
However, memory-subsystem interrupts (e.g., page faults) may require operation resumption.

This model resembles streaming accelerators.
An ACE implementation can be shared by multiple harts, each maintaining independent architectural state, and operates concurrently with CPU cores (including in-order cores).
This specification defines the extension's behavior, not its implementation, allowing for integrated designs.

[[ACE-introduction-features]]
=== Features

. ACE is an ISE for full-round, block-wise cryptographic operations that keeps keys concealed.
. It supports various cryptographic primitives and modes, including Side-Channel Attack (SCA) resistant versions.
  The specification includes mandatory, optional, and custom algorithms.
. Keys are stored in an architectural state called a _Cryptographic Context_ (CC), along with metadata binding the key to a specific algorithm and usage restrictions.
 * Keys in a CC are _opaque_ and cannot be extracted by software. CCs are not general-purpose read/write registers.
 * CCs are configured via software, System Key Tables, or dynamic key generation blocks.
. ACE instructions reference CCs rather than raw key values.
. ACE supports multiple concurrent active CCs.
. Trusted entities can provision opaque keys to less-trusted environments, enabling cryptographic operations without exposing key material.
  Once provisioned, keys are reusable without further interaction.
. ACE binds CCs to _Locales_ to prevent replay across different machines, product lines, or execution contexts (see <<ACE-concepts>> and <<ACE-locales>>).
. ACE enforces process-level access control for opaque keys, supporting:
 * Domain separation for keys.
 * Key preservation during process or VM migration.
. ACE scales from embedded to server cores using a unified ISA and ABI.
  Smaller cores may omit features transparently to user software.

This scalability supports cloud and edge deployments, providing essential support for secure key migration.

[[ACE-introduction-rationale]]
=== Rationale

ACE addresses the inadequacies of current solutions:

* Round-based ISAs require explicit key injection between rounds.
* Existing ISAs lack intrinsic trust mechanisms, relying on external IP or costly context switches to TEEs (e.g., TrustZone).
* External blocks and key management units impose significant latency and system stack overhead.
* Primitive-only support is insufficient for modes like AES-GCM-SIV, where derived keys must also remain protected.
* No currently ratified solution combines high performance, efficient key management, and high assurance.

[[ACE-introduction-more-features]]
=== Implied Features

To minimize environment switches and support efficient software-managed context switching, ACE supports the secure export and import of Cryptographic Contexts using authenticated encryption.
The complete model is specified in <<ACE-architecture>>.

=== Algorithms

Supported algorithms include AES-128 and AES-256 (ECB, CTR, GCM, GCM-SIV, XTS, CMAC) and potentially other block ciphers like SM4.
Hash support includes at least SHA-2 and HMAC-SHA-2.

[[ACE-introduction-non-features]]
=== Non-Features

ACE intentionally excludes the following:

* **Debugging support:** CC internal representations remain concealed even during debug.
* **Variable-length ciphertext and plaintext inputs:** ACE does not process variable-length ciphertext or plaintext.
* **Complete key management:** ACE provides architectural building blocks.
  Complex key management logic resides in trusted software (e.g., TEE applets).
  ACE does not support direct external key provisioning.
* **Key revocation:** Current specifications do not include a revocation mechanism.
  Future versions may support revocation via key identifiers and system-wide broadcasts.
* **Misuse prevention:** While ACE protects key values, compromised processes can still invoke operations using accessible CCs.
  ACE complements existing security measures like process isolation.
* **Operational misuse:** Certain modes (e.g., CTR) allow symmetric encryption/decryption, potentially enabling misuse by malicious processes.

[[ACE-outline]]
=== Outline

The remainder of this document details the extension.

//In <<Details>> the technical details of the architecture are presented, including a listing of the instructions and their semantics.

[.red]#*Discussion point:* _Can optional limitations even to import and export make sense and be useful?#_

[.red]#*Discussion point:* _Everything in this specification is still valid if the number of CCs is reduced to, say, 8. Immediate values to refer to CCs are still 5 bits long because the same field can also be used to refer to a GPR, but the only valid values for the CC number are 0 to 7._#
